<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Define paperformat with zero margins -->
    <record id="student_certificate_paperformat" model="report.paperformat">
        <field name="name">Student Certificate Report</field>
        <field name="format">A4</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">0</field>
        <field name="margin_bottom">0</field>
        <field name="margin_left">0</field>
        <field name="margin_right">0</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">0</field>
        <field name="dpi">96</field>
    </record>

    <!-- Certificate Report Action -->
    <record id="student_registration_certificate_report" model="ir.actions.report">
        <field name="name">Student Registration Certificate</field>
        <field name="model">university.student</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">student_certificates.student_registration_certificate_template</field>
        <field name="binding_model_id" ref="education_university_management.model_university_student"/>
        <field name="binding_type">report</field>
        <field name="paperformat_id" ref="student_certificates.student_certificate_paperformat"/>
    </record>

  <template id="student_registration_certificate_template">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="student">

        <!-- Styles (consider moving to a report asset bundle) -->
        <style>
          @page {
            size: A4 portrait;
            margin: 0;
          }
          html, body { margin:0 !important; padding:0 !important; background:#ffffff; font-size:13px; height:100%; }
          * { margin:0; padding:0; box-sizing:border-box; }
          main { margin:0; padding:0; width:100%; position:relative; height:100%; }
          .certificate-wrapper { width:100%; background:#ffffff; padding:0; margin:0; box-sizing:border-box; position:relative; height:1403px; min-height:1403px; overflow:hidden; }
          .header-section { background-color:#f5f5dc; position:relative; padding:60px 0; text-align:center; width:100%; margin:0; left:0; right:0; min-height:120px; }
          .header-top-border { height:2px; background-color:#d3d3d3; width:100%; position:absolute; top:0; left:0; right:0; }
          .header-bottom-band { height:8px; background-color:#8B0000; width:100%; position:absolute; bottom:0; left:0; right:0; }
          .header-logo { width:180px; height:auto; display:block; margin:0 auto 15px; }
          .header-title { font-size:28px; font-weight:bold; color:#333; margin-top:15px; text-transform:uppercase; font-family:serif; }
          .certificate-body { position:relative; z-index:1; padding:40px 20px; padding-bottom:80px; }
          .certificate-content { text-align:center; padding:60px 40px; font-size:16px; line-height:1.8; color:#333; }
          .certificate-title { font-size:24px; font-weight:bold; color:#8B0000; margin-bottom:30px; text-transform:uppercase; }
          .certificate-text { font-size:18px; margin:20px 0; font-style:italic; }
          .student-name { font-size:22px; font-weight:bold; color:#8B0000; margin:30px 0; }
          .certificate-details { font-size:16px; margin:15px 0; }
          .certificate-info-section { margin-top:40px; padding-top:30px; border-top:1px solid #ddd; text-align:left; }
          .certificate-info-label { font-weight:bold; font-size:14px; margin-right:10px; }
          .certificate-info-value { font-size:14px; }
          .certificate-info-row { margin:10px 0; }
          .certificate-letter-section { margin-top:40px; padding:20px; background-color:#f9f9f9; text-align:left; font-size:14px; line-height:1.6; }
          .certificate-letter-title { font-weight:bold; font-size:16px; margin-bottom:15px; color:#8B0000; }
          .body-seal { width:180px; height:auto; display:block; position:absolute; bottom:70px; left:150px; z-index:9; }
          .signature-section { position:absolute; bottom:70px; left:40px; text-align:left; width:300px; z-index:9; }
          .signature-title { font-size:13px; font-weight:normal; color:#333; margin-bottom:50px; }
          .signature-image { width:200px; height:auto; display:block; margin-bottom:10px; margin-top:50px; }
          .signature-line { width:250px; height:1px; background-color:#000; margin-bottom:5px; margin-top:50px; }
          .signature-name { font-size:13px; color:#333; margin-top:5px; }
          .certificate-footer { background-color:#8B0000; color:#ffffff; padding:15px; display:flex; justify-content:space-between; align-items:center; font-size:12px; width:100%; position:absolute; bottom:0px; left:0; right:0; z-index:10; height:auto; white-space:nowrap; }
          .footer-item { flex:1; white-space:nowrap; display:inline-block; }
          .footer-item:first-child { text-align:left; padding-right:145px; }
          .footer-item:nth-child(2) { text-align:center; padding-left:145px; padding-right:145px; }
          .footer-item:last-child { text-align:right; padding-left:145px; }
          .footer-label { font-weight:bold; white-space:nowrap; }
          .footer-value { font-weight:normal; white-space:nowrap; }
        </style>

        <!-- Use absolute base URL so wkhtmltopdf resolves assets correctly -->
        <t t-set="ABS"
           t-value="student.env['ir.config_parameter'].sudo().get_param('web.external.url')
                    or student.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
        
        <!-- Get current date -->
        <t t-set="today" t-value="datetime.date.today()"/>

        <main>
          <div class="certificate-wrapper">
            <!-- Header Section -->
            <div class="header-section" style="position:relative; z-index:1;">
              <!-- Top Border -->
              <div class="header-top-border"></div>

              <!-- Logo -->
              <img t-att-src="ABS + '/student_certificates/static/src/img/logo7.png'" class="header-logo" alt="UWEA Logo"/>

              <!-- Institution Name -->
              <div class="header-title">
                UNITED WORLD EDUCATION ACADEMY
              </div>

              <!-- Bottom Red Band -->
              <div class="header-bottom-band"></div>
            </div>

            <!-- Certificate Body -->
            <div class="certificate-body">
              <div class="certificate-content">
                <!-- Certificate Template Content -->
                <t t-if="student.certificate_template == 'registration'">
                  <div class="certificate-content" style="text-align:left; padding:40px 60px;">
                    <div style="margin-bottom:30px;">
                      <div style="margin-bottom:15px;"><strong>Date: <t t-esc="today.strftime('%d/%m/%Y')"/></strong></div>
                      <div style="margin-bottom:15px;"><strong>Subject: Certificate of Student Registration in a Study Program</strong></div>
                    </div>
                    
                    <div style="margin-bottom:20px;">
                      <div style="margin-bottom:15px;">To whom it may concern,</div>
                    </div>
                    
                    <div style="margin-bottom:20px; line-height:1.8;">
                      <div style="margin-bottom:15px;">
                        We hereby certify that the student <strong><t t-esc="student.full_name_english"/></strong>
                        <t t-if="student.full_name_arabic">
                          <span style="font-family: 'Arial', 'Tahoma', sans-serif; direction: rtl;">(<t t-esc="student.full_name_arabic"/>)</span>
                        </t>
                        <t t-if="student.passport_number">
                          , holder of <t t-if="student.nationality_id and student.nationality_id.name">
                            <t t-esc="student.nationality_id.name"/>
                          </t> passport number <strong><t t-esc="student.passport_number"/></strong>
                        </t>
                        <t t-if="student.emirati_id_number">
                          <t t-if="student.passport_number"> and </t>
                          <t t-if="not student.passport_number">, holder of </t>
                          Emirati ID number <strong><t t-esc="student.emirati_id_number"/></strong>
                        </t>
                        , is registered to study at the United World Education Academy in the first academic year of the <strong><t t-esc="student.program_name or 'Bachelor of Business Administration'"/></strong> program
                        <t t-if="student.program_name and 'University of West Alabama' in student.program_name or 'UWA' in student.program_name">
                          at the University of West Alabama (UWA)
                        </t>
                        <t t-if="student.academic_year">
                          for the academic year <strong><t t-esc="student.academic_year"/></strong>
                        </t>
                        <t t-if="student.license_number">
                          , under license number <strong><t t-esc="student.license_number"/></strong>
                        </t>
                        .
                      </div>
                      
                      <div style="margin-top:20px; margin-bottom:15px;">
                        This certificate has been issued upon <t t-if="student.gender == 'male'">his</t>
                        <t t-if="student.gender == 'female'">her</t>
                        <t t-if="not student.gender">their</t> request without incurring any legal liability toward third parties.
                      </div>
                      
                      <div style="margin-top:30px;">
                        Please accept our highest respect and appreciation.
                      </div>
                    </div>
                  </div>
                  
                  <!-- Letter to Students -->
                  <t t-if="student.letter_to_students">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Students</div>
                      <t t-out="student.letter_to_students"/>
                    </div>
                  </t>
                  
                  <!-- Letter to Employees -->
                  <t t-if="student.letter_to_employees">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Employees</div>
                      <t t-out="student.letter_to_employees"/>
                    </div>
                  </t>
                </t>
                
                <t t-if="student.certificate_template == 'completion'">
                  <div class="certificate-title">Certificate of Completion</div>
                  <div class="certificate-text">This is to certify that</div>
                  <div class="student-name"><t t-esc="student.full_name_english"/></div>
                  <t t-if="student.full_name_arabic">
                    <div class="student-name" style="font-family: 'Arial', 'Tahoma', sans-serif; direction: rtl; margin-top:10px;"><t t-esc="student.full_name_arabic"/></div>
                  </t>
                  <div class="certificate-text">has successfully completed the program</div>
                  <div class="certificate-details"><strong><t t-esc="student.program_name or 'Bachelor of Business Administration'"/></strong></div>
                  <t t-if="student.academic_year">
                    <div class="certificate-details">Academic Year: <t t-esc="student.academic_year"/></div>
                  </t>
                  <div class="certificate-text" style="margin-top:40px;">at United World Education Academy</div>
                  
                  <!-- Letter to Students -->
                  <t t-if="student.letter_to_students">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Students</div>
                      <t t-out="student.letter_to_students"/>
                    </div>
                  </t>
                  
                  <!-- Letter to Employees -->
                  <t t-if="student.letter_to_employees">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Employees</div>
                      <t t-out="student.letter_to_employees"/>
                    </div>
                  </t>
                </t>
                
                <t t-if="student.certificate_template == 'achievement'">
                  <div class="certificate-title">Certificate of Achievement</div>
                  <div class="certificate-text">This is to certify that</div>
                  <div class="student-name"><t t-esc="student.full_name_english"/></div>
                  <t t-if="student.full_name_arabic">
                    <div class="student-name" style="font-family: 'Arial', 'Tahoma', sans-serif; direction: rtl; margin-top:10px;"><t t-esc="student.full_name_arabic"/></div>
                  </t>
                  <div class="certificate-text">has demonstrated outstanding achievement in</div>
                  <div class="certificate-details"><strong><t t-esc="student.program_name or 'Bachelor of Business Administration'"/></strong></div>
                  <t t-if="student.academic_year">
                    <div class="certificate-details">Academic Year: <t t-esc="student.academic_year"/></div>
                  </t>
                  <div class="certificate-text" style="margin-top:40px;">at United World Education Academy</div>
                  
                  <!-- Letter to Students -->
                  <t t-if="student.letter_to_students">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Students</div>
                      <t t-out="student.letter_to_students"/>
                    </div>
                  </t>
                  
                  <!-- Letter to Employees -->
                  <t t-if="student.letter_to_employees">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Employees</div>
                      <t t-out="student.letter_to_employees"/>
                    </div>
                  </t>
                </t>
                
                <t t-if="student.certificate_template == 'enrollment'">
                  <div class="certificate-content" style="text-align:left; padding:40px 60px;">
                    <div style="margin-bottom:30px;">
                      <div style="margin-bottom:15px;"><strong>Date: <t t-esc="today.strftime('%d/%m/%Y')"/></strong></div>
                      <div style="margin-bottom:15px;"><strong>Subject: Certificate of Student Registration in a Study Program</strong></div>
                    </div>
                    
                    <div style="margin-bottom:20px;">
                      <div style="margin-bottom:15px;">To whom it may concern,</div>
                    </div>
                    
                    <div style="margin-bottom:20px; line-height:1.8;">
                      <div style="margin-bottom:15px;">
                        We hereby certify that the student <strong><t t-esc="student.full_name_english"/></strong>
                        <t t-if="student.full_name_arabic">
                          <span style="font-family: 'Arial', 'Tahoma', sans-serif; direction: rtl;">(<t t-esc="student.full_name_arabic"/>)</span>
                        </t>
                        <t t-if="student.passport_number">
                          , holder of <t t-if="student.nationality_id and student.nationality_id.name">
                            <t t-esc="student.nationality_id.name"/>
                          </t> passport number <strong><t t-esc="student.passport_number"/></strong>
                        </t>
                        <t t-if="student.emirati_id_number">
                          <t t-if="student.passport_number"> and </t>
                          <t t-if="not student.passport_number">, holder of </t>
                          Emirati ID number <strong><t t-esc="student.emirati_id_number"/></strong>
                        </t>
                        , is registered to study at the United World Education Academy in the first academic year of the <strong><t t-esc="student.program_name or 'Bachelor of Business Administration'"/></strong> program
                        <t t-if="student.program_name and 'University of West Alabama' in student.program_name or 'UWA' in student.program_name">
                          at the University of West Alabama (UWA)
                        </t>
                        <t t-if="student.academic_year">
                          for the academic year <strong><t t-esc="student.academic_year"/></strong>
                        </t>
                        <t t-if="student.license_number">
                          , under license number <strong><t t-esc="student.license_number"/></strong>
                        </t>
                        .
                      </div>
                      
                      <div style="margin-top:20px; margin-bottom:15px;">
                        This certificate has been issued upon <t t-if="student.gender == 'male'">his</t>
                        <t t-if="student.gender == 'female'">her</t>
                        <t t-if="not student.gender">their</t> request without incurring any legal liability toward third parties.
                      </div>
                      
                      <div style="margin-top:30px;">
                        Please accept our highest respect and appreciation.
                      </div>
                    </div>
                  </div>
                  
                  <!-- Letter to Students -->
                  <t t-if="student.letter_to_students">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Students</div>
                      <t t-out="student.letter_to_students"/>
                    </div>
                  </t>
                  
                  <!-- Letter to Employees -->
                  <t t-if="student.letter_to_employees">
                    <div class="certificate-letter-section">
                      <div class="certificate-letter-title">Letter to Employees</div>
                      <t t-out="student.letter_to_employees"/>
                    </div>
                  </t>
                </t>
                
                <t t-if="student.certificate_template == 'custom'">
                  <t t-out="student.custom_certificate_message or ''"/>
                </t>
              </div>
            </div>
            
            <!-- Seal at the bottom (left side) -->
            <img t-att-src="ABS + '/student_certificates/static/src/img/seal3.png'" class="body-seal" alt="Seal"/>
            
            <!-- Signature Section -->
            <div class="signature-section">
              <div class="signature-title">Chief Financial Officer</div>
              <img t-att-src="ABS + '/student_certificates/static/src/img/ismail_signature.png'" class="signature-image" alt="Signature"/>
              <div class="signature-line"></div>
              <div class="signature-name">Mr. Ismail Yahya</div>
            </div>
            
            <!-- Footer -->
            <div class="certificate-footer">
              <div class="footer-item"><span class="footer-label">TEL:</span> <span class="footer-value">+971-56-236-6905</span></div>
              <div class="footer-item"><span class="footer-label">WEB:</span> <span class="footer-value">www.uwuni.com</span></div>
              <div class="footer-item"><span class="footer-label">E-MAIL:</span> <span class="footer-value">info@uwuni.com</span></div>
            </div>
          </div>
        </main>

      </t>
    </t>
  </template>
</odoo>

